(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,12352,e=>{"use strict";let a="https://api.humanchat.com",t=async e=>{if(!e.ok)throw Error(await e.text().catch(()=>"")||"Request failed");return e.json()},s=(e={})=>({credentials:"include",headers:{"Content-Type":"application/json",...e.headers??{}},...e}),i=async()=>(await t(await fetch(`${a}/api/admin/overview`,s()))).metrics,n=async(e={})=>{let i=new URL("/api/admin/users",a);return e.q&&i.searchParams.set("q",e.q),e.role&&i.searchParams.set("role",e.role),"boolean"==typeof e.managed&&i.searchParams.set("managed",String(e.managed)),(await t(await fetch(i.toString(),s()))).users??[]},r=async(e,i)=>(await t(await fetch(`${a}/api/admin/users/${e}`,{...s({method:"PATCH"}),body:JSON.stringify(i)}))).user,l=async(e=60)=>{let i=new URL("/api/admin/sessions",a);return i.searchParams.set("limit",String(e)),(await t(await fetch(i.toString(),s()))).sessions??[]},d=async()=>(await t(await fetch(`${a}/api/admin/requests`,s()))).requests??[],c=async e=>{await t(await fetch(`${a}/api/admin/announcements`,{...s({method:"POST"}),body:JSON.stringify({message:e})}))},o=async()=>(await t(await fetch(`${a}/api/admin/announcements`,s()))).announcements??[];e.s(["fetchAdminAnnouncements",0,o,"fetchAdminOverview",0,i,"fetchAdminRequests",0,d,"fetchAdminSessions",0,l,"fetchAdminUsers",0,n,"publishAdminAnnouncement",0,c,"updateAdminUser",0,r])},53607,e=>{"use strict";var a=e.i(43476),t=e.i(71645),s=e.i(7670),i=e.i(12352);function n(){let[e,n]=(0,t.useState)([]),[r,l]=(0,t.useState)(!0),[d,c]=(0,t.useState)(null),[o,h]=(0,t.useState)(""),[m,x]=(0,t.useState)(""),[u,p]=(0,t.useState)("all");(0,t.useEffect)(()=>{let e=setTimeout(()=>x(o.trim()),400);return()=>clearTimeout(e)},[o]),(0,t.useEffect)(()=>{let e=!0;return(async()=>{l(!0);try{let a=await (0,i.fetchAdminUsers)({q:m||void 0,role:"all"===u?void 0:u});e&&(n(a),c(null))}catch(a){e&&c(a instanceof Error?a.message:"Unable to load users")}finally{e&&l(!1)}})(),()=>{e=!1}},[m,u]);let w=(0,t.useMemo)(()=>e.length?Math.round(e.filter(e=>e.managed).length/e.length*100):0,[e]),g=async(e,a)=>{try{let t=await (0,i.updateAdminUser)(e,{role:a});n(a=>a.map(a=>a.id===e?{...a,role:t.role}:a))}catch(e){c(e instanceof Error?e.message:"Unable to update role")}},f=async(e,a)=>{try{let t=await (0,i.updateAdminUser)(e,{managed:a});n(a=>a.map(a=>a.id===e?{...a,managed:t.managed}:a))}catch(e){c(e instanceof Error?e.message:"Unable to update managed flag")}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-semibold text-white",children:"People"}),(0,a.jsx)("p",{className:"text-white/60",children:"Manage host access, roles, and managed rosters."})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,a.jsx)("input",{type:"search",placeholder:"Search name or email",value:o,onChange:e=>h(e.target.value),className:"rounded-2xl border border-white/20 bg-white/5 px-4 py-2 text-sm text-white placeholder:text-white/50 focus:border-white"}),(0,a.jsxs)("select",{className:"rounded-2xl border border-white/20 bg-white/5 px-3 py-2 text-sm text-white",value:u,onChange:e=>p(e.target.value),children:[(0,a.jsx)("option",{value:"all",className:"text-black",children:"All roles"}),(0,a.jsx)("option",{value:"admin",className:"text-black",children:"Admins"}),(0,a.jsx)("option",{value:"manager",className:"text-black",children:"Managers"})]})]})]}),d&&(0,a.jsx)("div",{className:"rounded-2xl border border-red-400/30 bg-red-500/10 p-4 text-sm text-red-100",children:d}),(0,a.jsxs)("div",{className:"rounded-3xl border border-white/10 bg-white/5",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 border-b border-white/10 px-6 py-4 text-sm text-white/70",children:[(0,a.jsxs)("p",{children:["Showing ",e.length," people"]}),(0,a.jsxs)("p",{children:["Managed share · ",w,"%"]})]}),r?(0,a.jsx)("div",{className:"p-6 text-white/70",children:"Loading users…"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-white/10 text-left text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"text-white/60",children:[(0,a.jsx)("th",{className:"px-6 py-3",children:"Person"}),(0,a.jsx)("th",{className:"px-6 py-3",children:"Role"}),(0,a.jsx)("th",{className:"px-6 py-3",children:"Managed"}),(0,a.jsx)("th",{className:"px-6 py-3",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3",children:"Created"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-white/10",children:e.map(e=>(0,a.jsxs)("tr",{className:"text-white/90",children:[(0,a.jsxs)("td",{className:"px-6 py-3",children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-white/60",children:e.email})]}),(0,a.jsx)("td",{className:"px-6 py-3",children:(0,a.jsxs)("select",{className:"rounded-xl border border-white/20 bg-transparent px-2 py-1 text-sm",value:e.role,onChange:a=>g(e.id,a.target.value),children:[(0,a.jsx)("option",{value:"user",className:"text-black",children:"User"}),(0,a.jsx)("option",{value:"manager",className:"text-black",children:"Manager"}),(0,a.jsx)("option",{value:"admin",className:"text-black",children:"Admin"})]})}),(0,a.jsx)("td",{className:"px-6 py-3",children:(0,a.jsx)("button",{type:"button",onClick:()=>f(e.id,!e.managed),className:(0,s.default)("inline-flex items-center rounded-full border px-3 py-1 text-xs uppercase tracking-widest",e.managed?"border-aqua/50 bg-aqua/20 text-white":"border-white/30 text-white/60 hover:border-white/50"),children:e.managed?"Managed":"Individual"})}),(0,a.jsxs)("td",{className:"px-6 py-3 text-xs",children:[(0,a.jsx)("div",{className:(0,s.default)("font-semibold",e.is_online?"text-peach":"text-white/60"),children:e.is_online?"Online":"Offline"}),(0,a.jsx)("div",{className:"text-white/50",children:e.has_active_session?"In session":"Idle"})]}),(0,a.jsx)("td",{className:"px-6 py-3 text-white/60",children:new Date(e.created_at).toLocaleDateString()})]},e.id))})]})})]})]})}e.s(["default",()=>n])}]);